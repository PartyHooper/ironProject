<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href='/stylesheets/bootstrap.min.css' rel="stylesheet">
    <link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet">
    <link rel='stylesheet' href='/stylesheets/bootstrap-social.css' />
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <title>Hopper</title>
</head>
<body>
    <div class="topBar">
        <h2 class="title">Hopper</h2>
        <a href="/auth/facebook"><button class="btn-social-icon btn-facebook"><span class="fab fa-facebook-square"></span></button></a>
        <a href="/auth/instagram" ><button class="btn-social-icon btn-instagram"><span class="fab fa-instagram"></span></button></a>
    </div>
    <% places.forEach(function(place){ %>
        <div class="place-container">
            <figure class="crop-image">
                <img src=<%=place.picPath%>>
            </figure>
            <div class="rating-container">
            <p class="place-name"><%=place.name%></p>
            <% var avgRating = 0 %>
            <% var musicCount = 0 %>
            <% var crowdCount = 0 %>

            <% place.reviews.forEach(function(review){ %>
                <% avgRating+=review.rating/place.reviews.length; %>
                <% musicCount+=review.music/place.reviews.length; %>
                <% crowdCount+=review.crowded/place.reviews.length; %>
            <%})%>

            <p>Rating: <%=avgRating%></p>
            <% for(var s=0; s<avgRating; s++){%>
                    <% if (avgRating-1<s){%>
                         <span class="fas fa-star-half"></span>
                     <%} else {%>
                         <span class="fas fa-star"></span>
                    <% }%>
                 <%}%>
            </div>
            <div class="emotions-container">
            
            <% if (musicCount <1.5){ %>
                <p>Music: <i style="background-color: gold" class="fas fa-music icon-mus"></i></p>
            <% } else if (musicCount<2.5) {%>
                <p>Music: <i style="background-color: silver" class="fas fa-music icon-mus"></i></p>
            <%} else {%>
                <p>Music: <i style="background-color: #cd7f32" class="fas fa-music icon-mus"></i></p>
            <%}%>
            
            <% if (crowdCount <1.5){ %>
                    <span>Crowd:</span><img src="images/fullCrowd.png">
                <% } else if (musicCount<2.5) {%>
                    <span>Crowd:</span><img src="images/averageCrowd.png">
                <%} else {%>
                    <span>Crowd:</span><img src="images/empty.png">
            <%}%>
        </div>
        </div>
    <%})%>
</body>
</html>

